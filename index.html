<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>It's me, Shanaka</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000000;
            color: #ffffff;
            font-family: 'Quicksand', sans-serif;
            overflow: hidden; 
        }

        #webgl-canvas {
            position: fixed;
            top: 0;
            left: 0;
            outline: none;
            z-index: -1;
        }

        #page-container {
            position: relative;
            height: 100vh;
            transition: transform 1.2s cubic-bezier(0.76, 0, 0.24, 1);
        }

        .content-section {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 1rem;
            box-sizing: border-box;
            position: relative;
        }

        .content-wrapper {
            max-width: 650px;
            width: 100%;
            padding: 2rem;
            background-color: rgba(20, 20, 20, 0.7);
            border-radius: 1rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            position: relative;
            border: 1px solid transparent;
            transition: border-color 0.4s ease, box-shadow 0.4s ease;
        }
        
        .content-wrapper:hover {
            border-color: rgba(66, 165, 245, 0.5);
            box-shadow: 0 0 25px rgba(66, 165, 245, 0.3);
        }
        
        #home-wrapper {
            padding-top: 75px; 
        }
        
        #home-wrapper p {
            margin-top: 1.5rem;
        }

        h1 {
            font-family: 'Fira Code', monospace;
            font-size: 2.8rem;
            font-weight: 700;
            margin-top: 0;
            margin-bottom: 1.5rem;
        }

        p {
            font-size: 1.2rem;
            line-height: 1.7;
        }
        
        @keyframes siri-glow {
            0% { text-shadow: 0 0 8px rgba(255, 255, 255, 0.4); }
            50% { text-shadow: 0 0 20px rgba(255, 255, 255, 0.8); }
            100% { text-shadow: 0 0 8px rgba(255, 255, 255, 0.4); }
        }

        h1:hover, p:not(.signature):hover {
            animation: siri-glow 1.5s infinite ease-in-out;
        }

        .signature {
            font-family: 'Dancing Script', cursive;
            font-size: 2.2rem;
            text-align: right;
            margin-top: 2rem;
            margin-right: 1rem;
            color: #42a5f5;
        }
        
        @keyframes signature-glow {
            0% { text-shadow: 0 0 10px rgba(66, 165, 245, 0.5); }
            50% { text-shadow: 0 0 25px rgba(66, 165, 245, 1); }
            100% { text-shadow: 0 0 10px rgba(66, 165, 245, 0.5); }
        }

        .signature:hover {
            animation: signature-glow 1.5s infinite ease-in-out;
        }

        #profile-pic {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 4px solid #ffffff;
            object-fit: cover;
            position: absolute;
            top: -75px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        }

        #blog-posts-container {
            width: 100%;
        }

        .blog-post {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            text-align: left;
            transition: background-color 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .blog-post:hover {
            background-color: rgba(255, 255, 255, 0.15);
        }

        .blog-post a { text-decoration: none; color: #ffffff; display: block; }
        .blog-post h3 { margin: 0 0 0.5rem 0; color: #42a5f5; font-size: 1.5rem; }
        .blog-post p { font-size: 1rem; line-height: 1.5; margin: 0; opacity: 0.8; }
        
        #see-more-link {
            display: inline-block;
            margin-top: 1rem;
            padding: 0.5rem 1rem;
            color: #42a5f5;
            text-decoration: none;
            border: 1px solid #42a5f5;
            border-radius: 0.5rem;
            transition: background-color 0.3s, color 0.3s;
        }
        #see-more-link:hover { background-color: #42a5f5; color: #000000; }
        
        .social-links-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin-top: 2rem;
        }

        .social-link { color: #ffffff; transition: color 0.3s ease; }
        .social-link:hover { color: #42a5f5; }
        .social-link svg { width: 40px; height: 40px; fill: currentColor; }
        
        #scroll-indicator {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            color: rgba(255, 255, 255, 0.7);
            transition: opacity 0.5s ease;
        }

        #scroll-indicator svg {
            width: 24px;
            height: 24px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @media (max-width: 768px) {
            body {
                overflow-y: auto; /* Enable scrolling on mobile */
            }

            #page-container {
                /* Enable scroll snapping for a mobile-friendly experience */
                scroll-snap-type: y mandatory;
                overflow-y: scroll;
                height: 100vh;
                transform: none !important; /* Disable JS transform on mobile */
            }
            
            .content-section {
                scroll-snap-align: start; /* Snap each section to the top */
                height: 100vh; /* Ensure sections take full viewport height */
            }

            h1 { font-size: 2rem; }
            p { font-size: 1rem; }
            .content-wrapper { padding: 1.5rem; }
            #profile-pic { width: 120px; height: 120px; top: -60px; }
            #home-wrapper { padding-top: 60px; }
            .blog-post h3 { font-size: 1.2rem; }
            .social-links-container { gap: 1.5rem; }
            .social-link svg { width: 35px; height: 35px; }
            .signature { font-size: 1.8rem; }
            #scroll-indicator { display: none; } /* Hide desktop scroll indicator */
        }

    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Fira+Code:wght@700&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>

    <canvas id="webgl-canvas"></canvas>
    
    <div id="scroll-indicator">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"/>
            <path fill-rule="evenodd" d="M7.646 8.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 9.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"/>
        </svg>
    </div>

    <div id="page-container">
        <div class="content-section">
            <div class="content-wrapper" id="home-wrapper">
                <img src="https://avatars3.githubusercontent.com/u/11259401?s=400&u=51032e514fcd603a20d7497cd113e75d338d0163&v=4" id="profile-pic" alt="A circular profile picture of Shagihan">
                <h1>About Me</h1>
                <p>Hello! I'm Shagihan. As a dedicated and passionate individual working my way up in the software industry, I thrive on challenges and continuous learning. My journey through the Sri Lanka Institute of Information Technology equipped me with strong technical skills, but it's my leadership qualities and quick learning ability that truly drive me to build innovative and impactful solutions.</p>
                <p class="signature">- Shagihan</p>
            </div>
        </div>
        <div class="content-section" id="blog-section">
            <div class="content-wrapper">
                <h1>Latest Posts</h1>
                <div id="blog-posts-container">
                    <p>Loading posts from Medium...</p>
                </div>
            </div>
        </div>
        <div class="content-section" id="contact-section">
            <div class="content-wrapper">
                <h1>Connect With Me</h1>
                <div class="social-links-container">
                    <a href="https://www.linkedin.com/in/shagihan/" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="LinkedIn"><svg viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></a>
                    <a href="https://github.com/shagihan" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="GitHub"><svg viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg></a>
                    <a href="https://twitter.com/shagihan" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="X (formerly Twitter)"><svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24h-6.617l-5.21-6.817-6.022 6.817h-3.308l7.732-8.835-8.211-10.665h6.836l4.556 6.231 5.49-6.231zm-1.161 17.52h1.839l-10.125-13.9h-1.998l10.284 13.9z"/></svg></a>
                    <a href="https://medium.com/@shagihan" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="Medium"><svg viewBox="0 0 24 24"><path d="M7.45,18.26H5.66V5.74H7.45ZM14,18.26h-.21l-3.4-8.34,3.4-4.18h.21V18.26Zm.88,0V5.74h4.15a4.26,4.26,0,0,1,1.5.25,2.18,2.18,0,0,1,1.17,1,2,2,0,0,1,.41,1.33,2.44,2.44,0,0,1-.57,1.74,3.33,3.33,0,0,1-1.5,1.15l2.54,6.81h-2L17.3,13.05H14.86V18.26Z"/></svg></a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // --- Three.js Setup ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('webgl-canvas'), antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        camera.position.z = 5;
        scene.add(new THREE.AmbientLight(0xffffff, 0.5));
        const pointLight = new THREE.PointLight(0xffffff, 1);
        pointLight.position.set(5, 5, 5);
        scene.add(pointLight);

        // --- Particle Creation ---
        let points;
        let originalPositions, randomDirections, sandPositions;
        const particleCount = 40000;
        const geometry = new THREE.TorusKnotGeometry(1.8, 0.5, 300, 48);
        const positions = new Float32Array(particleCount * 3);
        originalPositions = new Float32Array(particleCount * 3);
        randomDirections = new Float32Array(particleCount * 3);
        sandPositions = new Float32Array(particleCount * 3);
        const tempPositions = geometry.attributes.position.array;
        const tempCount = geometry.attributes.position.count;
        const floorY = -6;
        for (let i = 0; i < particleCount; i++) {
            const i3 = i * 3;
            const randomVertexIndex = Math.floor(Math.random() * tempCount);
            const v3 = randomVertexIndex * 3;
            positions[i3] = tempPositions[v3];
            positions[i3 + 1] = tempPositions[v3 + 1];
            positions[i3 + 2] = tempPositions[v3 + 2];
            originalPositions[i3] = positions[i3];
            originalPositions[i3 + 1] = positions[i3 + 1];
            originalPositions[i3 + 2] = positions[i3 + 2];
            randomDirections[i3] = (Math.random() - 0.5) * 15;
            randomDirections[i3 + 1] = (Math.random() - 0.5) * 15;
            randomDirections[i3 + 2] = (Math.random() - 0.5) * 15;
            sandPositions[i3] = (Math.random() - 0.5) * 10;
            sandPositions[i3 + 1] = floorY + (Math.random() - 0.5) * 0.5;
            sandPositions[i3 + 2] = (Math.random() - 0.5) * 10;
        }
        geometry.dispose();
        const particleGeometry = new THREE.BufferGeometry();
        particleGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        const particleMaterial = new THREE.PointsMaterial({ color: 0x42a5f5, size: 0.025, transparent: true, blending: THREE.AdditiveBlending, depthWrite: false });
        points = new THREE.Points(particleGeometry, particleMaterial);
        points.renderOrder = 1;
        scene.add(points);

        // --- Subtle Meteor Shower using Cylinders ---
        const meteors = [];
        const meteorCount = 40;
        const meteorMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.3, depthWrite: false });
        const meteorGeometry = new THREE.CylinderGeometry(0.01, 0.01, 1.0, 8);
        for (let i = 0; i < meteorCount; i++) {
            const meteor = new THREE.Mesh(meteorGeometry, meteorMaterial);
            meteor.velocity = new THREE.Vector3((Math.random() - 0.5) * 0.03, -0.1 - Math.random() * 0.05, 0);
            meteor.position.x = (Math.random() - 0.5) * 25;
            meteor.position.y = 10 + Math.random() * 10;
            meteor.position.z = (Math.random() - 0.5) * 15;
            meteor.quaternion.setFromUnitVectors(new THREE.Vector3(0, 1, 0), meteor.velocity.clone().normalize());
            meteor.visible = false;
            meteor.renderOrder = 0;
            meteors.push(meteor);
            scene.add(meteor);
        }

        // --- Dynamic Color Change ---
        const colors = [ new THREE.Color(0x42a5f5), new THREE.Color(0xef5350), new THREE.Color(0x66bb6a), new THREE.Color(0xffca28), new THREE.Color(0xab47bc) ];
        let colorIndex = 0;
        setInterval(() => { colorIndex = (colorIndex + 1) % colors.length; }, 7000);

        // --- Unified Scroll Logic ---
        const pageContainer = document.getElementById('page-container');
        const scrollIndicator = document.getElementById('scroll-indicator');
        const sections = document.querySelectorAll('.content-section');
        const totalSections = sections.length;
        let currentSectionIndex = 0;
        let isAnimating = false;
        const isMobile = window.innerWidth <= 768;

        function goToSection(index) {
            if (index < 0 || index >= totalSections || isAnimating) return;
            isAnimating = true;
            currentSectionIndex = index;
            pageContainer.style.transform = `translateY(-${currentSectionIndex * 100}vh)`;
            scrollIndicator.style.opacity = (index === 0) ? '1' : '0';
            setTimeout(() => { isAnimating = false; }, 1200);
        }

        if (!isMobile) {
            window.addEventListener('wheel', event => {
                if (isAnimating) return;
                if (event.deltaY > 0) goToSection(currentSectionIndex + 1);
                else goToSection(currentSectionIndex - 1);
            });
            window.addEventListener('keydown', event => {
                if (isAnimating) return;
                if (event.key === 'ArrowDown') goToSection(currentSectionIndex + 1);
                else if (event.key === 'ArrowUp') goToSection(currentSectionIndex - 1);
            });
        } else {
            pageContainer.addEventListener('scroll', () => {
                const scrollPos = pageContainer.scrollTop;
                const sectionHeight = window.innerHeight;
                currentSectionIndex = Math.round(scrollPos / sectionHeight);
            });
        }
        
        // --- Animation Loop ---
        const clock = new THREE.Clock();
        const mouse = new THREE.Vector2();
        let currentScrollPercent = 0;
        let targetScrollPercent = 0;

        function animate() {
            requestAnimationFrame(animate);
            
            const targetColor = colors[colorIndex];
            points.material.color.lerp(targetColor, 0.03);

            // Calculate target scroll percent based on device
            if (isMobile) {
                const scrollableHeight = pageContainer.scrollHeight - pageContainer.clientHeight;
                targetScrollPercent = pageContainer.scrollTop / scrollableHeight;
            } else {
                targetScrollPercent = currentSectionIndex / (totalSections - 1);
            }
            currentScrollPercent = THREE.MathUtils.lerp(currentScrollPercent, targetScrollPercent, 0.07);

            const isLastSection = currentSectionIndex === totalSections - 1;
            const posArray = points.geometry.attributes.position.array;
            for (let i = 0; i < particleCount; i++) {
                const i3 = i * 3;
                const explodedX = originalPositions[i3] + randomDirections[i3];
                const explodedY = originalPositions[i3 + 1] + randomDirections[i3 + 1];
                const explodedZ = originalPositions[i3 + 2] + randomDirections[i3 + 2];
                let currentX, currentY, currentZ;

                if (isLastSection) {
                    const prevScrollPercent = (totalSections - 2) / (totalSections - 1);
                    const prevStateX = THREE.MathUtils.lerp(originalPositions[i3], explodedX, prevScrollPercent);
                    const prevStateY = THREE.MathUtils.lerp(originalPositions[i3 + 1], explodedY, prevScrollPercent);
                    const prevStateZ = THREE.MathUtils.lerp(originalPositions[i3 + 2], explodedZ, prevScrollPercent);
                    const lastSectionProgress = (currentScrollPercent - prevScrollPercent) / (1 - prevScrollPercent);
                    const sandProgress = Math.max(0, Math.min(1, lastSectionProgress));
                    currentX = THREE.MathUtils.lerp(prevStateX, sandPositions[i3], sandProgress);
                    currentY = THREE.MathUtils.lerp(prevStateY, sandPositions[i3 + 1], sandProgress);
                    currentZ = THREE.MathUtils.lerp(prevStateZ, sandPositions[i3 + 2], sandProgress);
                } else {
                    currentX = THREE.MathUtils.lerp(originalPositions[i3], explodedX, currentScrollPercent);
                    currentY = THREE.MathUtils.lerp(originalPositions[i3 + 1], explodedY, currentScrollPercent);
                    currentZ = THREE.MathUtils.lerp(originalPositions[i3 + 2], explodedZ, currentScrollPercent);
                }
                posArray[i3] = currentX;
                posArray[i3 + 1] = currentY;
                posArray[i3 + 2] = currentZ;
            }
            points.geometry.attributes.position.needsUpdate = true;
            points.rotation.y = mouse.x * 0.2;
            points.rotation.x = -mouse.y * 0.2;
            points.rotation.z += 0.0005;

            // --- Meteor Shower Animation ---
            const showMeteors = currentSectionIndex === 0 || isLastSection;
            meteors.forEach(meteor => {
                meteor.visible = showMeteors;
                if (showMeteors) {
                    meteor.position.x += meteor.velocity.x;
                    meteor.position.y += meteor.velocity.y;
                    meteor.position.z += meteor.velocity.z;

                    if (meteor.position.y < -10) {
                        meteor.position.x = (Math.random() - 0.5) * 25;
                        meteor.position.y = 10 + Math.random() * 10;
                        meteor.position.z = (Math.random() - 0.5) * 15;
                    }
                }
            });

            renderer.render(scene, camera);
        }
        animate();
        
        // --- Other Listeners and Functions ---
        window.addEventListener('mousemove', (event) => {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
        });
        window.addEventListener('resize', () => {
            // Simple reload on resize can be a robust way to handle mobile orientation changes
            window.location.reload();
        });
        async function fetchMediumFeed() {
            const mediumUsername = 'shagihan';
            const mediumProfileUrl = `https://medium.com/@${mediumUsername}`;
            const rssToJsonApiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${mediumProfileUrl}/feed`;
            const blogContainer = document.getElementById('blog-posts-container');
            try {
                const response = await fetch(rssToJsonApiUrl);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                if (data.status !== 'ok' || !data.items || data.items.length === 0) {
                     blogContainer.innerHTML = '<p>Could not fetch posts or no posts found.</p>';
                     return;
                }
                blogContainer.innerHTML = '';
                const postsToShow = data.items.slice(0, 5);
                postsToShow.forEach(item => {
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = item.description;
                    const snippet = tempDiv.textContent.trim().substring(0, 150) + '...';
                    const postElement = document.createElement('div');
                    postElement.classList.add('blog-post');
                    postElement.innerHTML = `<a href="${item.link}" target="_blank" rel="noopener noreferrer"><h3>${item.title}</h3><p>${snippet}</p></a>`;
                    blogContainer.appendChild(postElement);
                });
                const seeMoreLink = document.createElement('a');
                seeMoreLink.id = 'see-more-link';
                seeMoreLink.href = mediumProfileUrl;
                seeMoreLink.target = '_blank';
                seeMoreLink.rel = 'noopener noreferrer';
                seeMoreLink.textContent = 'See More on Medium';
                document.getElementById('blog-section').querySelector('.content-wrapper').appendChild(seeMoreLink);
            } catch (error) {
                console.error("Error fetching Medium feed:", error);
                blogContainer.innerHTML = '<p>Sorry, there was an error fetching the blog posts.</p>';
            }
        }
        fetchMediumFeed();
    </script>
</body>
</html>
